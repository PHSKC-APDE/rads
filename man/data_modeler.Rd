% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data_modeler.R
\name{data_modeler}
\alias{data_modeler}
\title{Generate synthetic data for use in public sharing or testing}
\usage{
data_modeler(
  ph.data,
  number_of_observations = 100,
  comments = TRUE,
  return_code = FALSE,
  print_code = TRUE,
  categorical_threshold = 61,
  proportional_threshold = 0.75
)
}
\arguments{
\item{ph.data}{a data.table or data.frame to model synthetic data on.}

\item{number_of_observations}{integer >= 1. Sets the number of observations to create in the synthetic data}

\item{comments}{logical vector of length 1. Indicate if code should include comments. Comments describe how each column was defined.}

\item{return_code}{logical vector of length 1. Indicates if the user wants the function to return a list of code strings used to model the data (TRUE) or a data.table of the synthetic data (FALSE)}

\item{print_code}{logical vector of length 1. Indicates if the code generated by the modeler should be printed to console. Note, if you wish to copy and paste the code for use in your own work, it is recommended to use this console output.}

\item{categorical_threshold}{integer >= 1. Threshold for the number of unique values in a variable at or below which data_modeler() will treat the value as cateogircal, default 61.}

\item{proportional_threshold}{floating point between 0 and 1 incusive. Threshold for the proportion of observations that must be unique, below which data modeler() will treat the value as categorical, default 0.75}
}
\value{
When \code{return_code = FALSE}, returns a data.table containing synthetic data with the same structure as \code{ph.data}. When \code{return_code = TRUE}, returns a list of character strings that can be evaluated to generate the synthetic data. If \code{print_code = TRUE}, the generated code is also printed to the console. If \code{comments = TRUE}, code will include comments describing the data type of each column.
}
\description{
Receives a data table of public health data and returns a synthetic version that is identically structured but uncorrelated. User may request results as a data.table or as code that will generate the data once executed.
}
\details{
\code{data_modeler()} receives a data.table object and returns a data.table of similar structure and content, but with uncorrelated data across columns. For example, a column of dates will become a column of dates of a similar range, and distribution, but randomly distributed across observations. Common use cases include:
A) demonstrating a statistic or visualization without exposing the audience to "real" data or results
B) sharing code that generates a data set for minimally viable examples used in requesting help from, or teaching, others
C) creating data sets programmatically for (unit) testing or trainin

There are two kinds of output that \code{data_modeler()} returns, either the data table itself, or a list of strings that can be evaluated to create the data.table. In addition, \code{data_modeler()} can output-to-terminal a human readable version of the generation code that the user can copy and paste into their own scripts for sharing publicly.

\code{data_modeler()} makes some guesses as to if a column's content should be randomized (such as person names or blood pressures) or kept but randomly distributed (such as levels of response to a question or city names). This is intended to generate random data or to retain original categories where appropriate. It bases these guesses on the data type (integer or string), and complexity (e.g. 75\% being unique data), but not the meaning of the data (i.e. it doesn't know that a number is a "zip code" and doesn't know that a string is a "human name"). Variables that are identified as non-categorical will, in most cases, be replaced with a uniform distribution of noisy, but similarly shaped, data (e.g. floating point numbers of the same range and precision, but in a random uniform distribution, or a "lore ipsum" string of similar lengths). Variables identified as categorical will, in most cases, be replaced with identical categories in a similar distribution to the original, but randomly assigned across observations (e.g., a data set of 95\% males and 5\% females would still generate a data set of roughly 95\% males and 5\% females).

Two parameters are available to adjust the assumptions data_modeler uses to identify categorical values. These are "categorical_threshold" and "proportional_threshold".
\enumerate{
\item "categorical_threshold": defines how many unique categories can exist in the variable before data_modeler assumes the variable isn't categorical. Above this number, and the value will not be considered categorical. This currently defaults to 61.
\item "proportional_threshold": defines the proportion of values that can be unique before data_modeler() assumes the variable isn't categorical. This currently defaults to 0.75.
}

Each time data_modeler is executed, there is a randomness to how the data are created. If you wish to create identical data sets, be sure to set seed before executing.

A warning about data privacy:

\code{data_modeler()} creates an uncorrelated column of data to substitute the original by randomly reassigning values across that column. However, this does not ensure that meaningful information is not passed along. Note that, in most cases, categorical observations are distributed in proportion to the source data. So, if the provided data set is of categorical outcomes in a single population, the uncorrelated result would still show a similar rate of that outcome in that population because all observations would be for the same population group. The analyst should consider if this is acceptable or not and take measures to correct if necessary by either changing the input data or modifying the synthetic data. A simple approach in the above example would be to add one or more additional population groups so that the outcomes would be distributed removing the ability to estimate the rate for the smaller population (in an uncorrelated result, the rate of the categorical outcome would tend to be similar in all populations.)
}
\examples{
\donttest{
  library(data.table)
  observations <- 1000
  ph.data <- data.table(
    id = 1:observations,
    chi_geo_kc = sample(c('King County',NA_character_), observations, replace = TRUE),
    chi_race_7 = factor(sample(
      c("Asian", "AIAN", "Black", "Hispanic", "NHPI", "White", "Other", "Multiple", NA),
      observations, replace = TRUE, prob = c(.19,.01,.07,.11,.01,.35,.07,.14,.02)),
      levels = c("Asian", "AIAN", "Black", "Hispanic", "NHPI", "White", "Other", "Multiple", NA)),
    chi_sex = as.factor(sample(c("Male","Female"), observations, replace = TRUE)),
    chi_geo_region = factor(sample(c("South", "North", "Seattle", "East"), observations,
      replace = TRUE), levels = c("South","North","Seattle","East")),
    indicator1 = as.factor(sample(c("never","sometimes", "always", NA), observations,
    replace = TRUE)))

  ##Observe that modeled data have the same structure as the original
  DT.synthetic.data <- data_modeler(ph.data = ph.data,
                                   number_of_observations =  10000,
                                   comments = TRUE,
                                   return_code = FALSE,
                                   print_code = FALSE)
  str(ph.data)
  str(DT.synthetic.data)


  ## Manually convert received code into data
  DT.code <- data_modeler(ph.data = ph.data,
                                    number_of_observations =  10000,
                                    comments = TRUE,
                                    return_code = TRUE,
                                    print_code = TRUE)
  codeText <- paste(unlist(DT.code), collapse =" \n" )
  DT.synthetic.data.manual <- eval( parse(text = paste0(codeText)))
  str(ph.data)
  str(DT.synthetic.data.manual)
}

}
\references{
\url{https://github.com/PHSKC-APDE/rads/wiki/utilities#data_modeler}
}
\keyword{data}
\keyword{synthetic}
