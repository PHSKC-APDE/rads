% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/chars_functions.R
\name{chars_icd_ccs_count}
\alias{chars_icd_ccs_count}
\title{Count (non-injury) Comprehensive Hospital Abstract Reporting System
(CHARS) hospitalizations}
\usage{
chars_icd_ccs_count(
  ph.data = NULL,
  icdcm_version = 10,
  CMtable = NULL,
  icdcm = NULL,
  superlevel = NULL,
  broad = NULL,
  midlevel = NULL,
  detailed = NULL,
  icdcol = "diag1",
  group_by = NULL,
  kingco = TRUE,
  ...
)
}
\arguments{
\item{ph.data}{a data.table or data.frame. Must contain CHARS data structured
with one person per row and with at least one column of ICD CM codes.

\strong{NOTE!} ph.data must have a column named \code{seq_no}, which is a unique patient
level identifier.

The default is \code{ph.data = NULL}}

\item{icdcm_version}{an integer vector of length one specifying the ICD CM
version that you want to reference. Acceptable options include: \code{9}
or \code{10}.

The default is \code{icdcm_version = 10}.}

\item{CMtable}{An optional data.table containing the reference table of ICD codes
and their classifications. This should come from \code{\link[=chars_icd_ccs]{chars_icd_ccs()}}
and have the following columns: \code{icdcm_code}, \code{icdcm}, \code{superlevel},
\code{broad}, \code{midlevel}, \code{detailed}, and \code{icdcm_version}. If
provided, the function will use this table instead of making a new call to
\code{\link[=chars_icd_ccs]{chars_icd_ccs()}}, which can significantly improve performance when
making multiple calls to this function.

The default is \code{CMtable = NULL}, which means the function will fetch the reference
table from the database using \code{\link[=chars_icd_ccs]{chars_icd_ccs()}}.}

\item{icdcm}{a character vector of length 1. An ICD CM description OR code.
It is case agnostic and works with partial strings. For example, both
'rotavira' & 'A080' would provide the results for 'Rotaviral enteritis' for
ICD-10-CM. You can also combine multiple search terms. For example,
'rotavira|choler' would count all Rotaviral enteritis AND cholera
hospitalizations. View available options with
\code{chars_icd_ccs(ref_type = 'icdcm', icdcm_version = 10)}.

The default is \code{icdcm = NULL}}

\item{superlevel}{a character vector of length 1. Case agnostic and works
with partial strings. View available options with
\code{chars_icd_ccs(ref_type = 'superlevel', icdcm_version = 10)}.

The default is \code{superlevel = NULL}}

\item{broad}{a character vector of length 1. Case agnostic and works with
partial strings. View available options with
\code{chars_icd_ccs(ref_type = 'broad', icdcm_version = 10)}.

The default is \code{broad = NULL}}

\item{midlevel}{a character vector of length 1. Case agnostic and works with
partial strings. View available options with
\code{chars_icd_ccs(ref_type = 'midlevel', icdcm_version = 10)}.

The default is \code{midlevel = NULL}}

\item{detailed}{a character vector of length 1. Case agnostic and works with
partial strings. View available options with
\code{chars_icd_ccs(ref_type = 'detailed', icdcm_version = 10)}.

The default is \code{detailed = NULL}}

\item{icdcol}{A character vector of length 1 specifying the name of the column
in \code{ph.data} that contains ICD-CM diagnosis codes.

Values must be properly formatted ICD-9-CM or ICD-10-CM codes; codes are
coerced to uppercase and stripped of punctuation (e.g., \code{A85.2} → \code{A852}).
For ICD-10-CM, codes must begin with a capital letter followed by a digit
(invalid codes are set to \code{NA}).

The default is \code{icdcol = 'diag1'}, which refers to the principal
diagnosis code provided by \code{\link[apde.data:chars]{apde.data::chars()}}.}

\item{group_by}{a character vector of indeterminate length. This is used to
specify all the variables by which you want to group (a.k.a. stratify) the
results. For example, if you specified \code{group_by = c('chi_sex', 'chi_race_6')}, the results would be stratified by each combination of sex
and race.

The default is \code{group_by = NULL}}

\item{kingco}{a logical vector of length one. It specifies whether you want to
limit the analysis to King County. Note that this only works with data imported
with the \code{\link[apde.data:chars]{apde.data::chars()}} function because it needs the variable
chi_geo_kc`.

The default is \code{kingco = TRUE}.}

\item{...}{Additional arguments passed to other methods (currently unused).}
}
\value{
Generates a table with columns for each of the search terms you entered (e.g.,
\code{icdcm}, \code{broad}, and/or \code{detailed}) as well as
any \code{group_by} variables and a column named \code{hospitalizations} that
contains the relevant counts.
}
\description{
Generate hospitalization counts from WA State Comprehensive Hospital
Abstract Reporting System (CHARS) data using partial strings from the ICD-10-CM
or ICD-9-CM descriptions or AHRQ HCUP's CCSR based 'broad' and 'detailed'
classifications. Needs line-level CHARS data with a properly formatted
ICD-CM column (e.g., the data available from \code{\link[apde.data:chars]{apde.data::chars()}}).

See \code{\link[=chars_icd_ccs]{chars_icd_ccs()}} for a complete list of available ICD-10-CM,
ICD-9-CM, and superlevel, broad, midlevel, and narrow classifications.

\strong{¡¡¡REMEMBER!!!} ICD-10-CM started in 2016! Be sure to use the correct
\strong{\code{icdcm_version}}.
}
\details{
This function needs the user to enter a search string in one or more of the
following arguments in order to search the CHARS data for the corresponding
ICD CM codes:
\itemize{
\item \code{icdcm}
\item \code{superlevel}
\item \code{broad},
\item \code{midlevel}, or
\item \code{detailed}.
}

Partial search terms are acceptable and they are case-insensitive. For
example, if you set \code{broad = 'ex'} with \code{icdcm_version = 10}, the
function would return counts for \emph{"Diseases of the eye and adnEXa"} as well as
\emph{"EXternal causes of morbidity"}. It also understands simple regex syntax,
including \strong{\code{^}}, \strong{\code{$}}, and \strong{\code{|}}.

\strong{Note:} If you submit values for more than one of \code{icdcm},
\code{superlevel}, \code{broad}, \code{midlevel}, or \code{detailed}, they must
be nested. For example, \verb{broad = 'neoplasms', detailed = 'sarcoma'} will
give results because sarcomas are type of cancers. However,
\verb{broad = 'neoplasms', detailed = 'intestinal infection'} will return an
error because your resulting table will have zero rows.
}
\examples{
\donttest{
myresult <- chars_icd_ccs_count(ph.data = rads.data::synthetic_chars,
                                detailed = 'headache',
                                group_by = c('temperament'),
                                kingco = FALSE)
print(myresult)

myrefTable <- chars_icd_ccs()
myresult <- chars_icd_ccs_count(ph.data = rads.data::synthetic_chars,
                                CMtable = myrefTable,
                                detailed = 'asthma',
                                group_by = c('temperament'),
                                kingco = FALSE)
print(myresult)
}

}
